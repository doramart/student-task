"use strict";(self["webpackChunk_student_task_client"]=self["webpackChunk_student_task_client"]||[]).push([[413],{413:function(e,n,t){t.r(n),t.d(n,{default:function(){return u}});var o=function(){var e=this,n=e._self._c;return n("div",{staticClass:"login-container"},[e._m(0),n("div",{staticClass:"login-form"},[n("van-cell-group",[n("van-field",{attrs:{name:"email",label:"é‚®ç®±",placeholder:"è¯·è¾“å…¥é‚®ç®±åœ°å€",rules:e.emailRules,"left-icon":"envelop-o",clearable:""},model:{value:e.form.email,callback:function(n){e.$set(e.form,"email",n)},expression:"form.email"}}),n("van-field",{attrs:{name:"code",label:"éªŒè¯ç ",placeholder:"è¯·è¾“å…¥6ä½éªŒè¯ç ",rules:e.codeRules,"left-icon":"shield-o",clearable:"",maxlength:"6"},scopedSlots:e._u([{key:"button",fn:function(){return[n("van-button",{attrs:{size:"small",type:"primary",disabled:!e.canSendCode||e.sendingCode,loading:e.sendingCode},on:{click:e.handleSendCode}},[e._v(" "+e._s(e.sendButtonText)+" ")])]},proxy:!0}]),model:{value:e.form.code,callback:function(n){e.$set(e.form,"code",n)},expression:"form.code"}}),n("div",{staticClass:"login-button-container"},[n("van-button",{attrs:{round:"",block:"",type:"primary",loading:e.loggingIn,disabled:!e.form.email||!e.form.code},on:{click:e.handleLogin}},[e._v(" "+e._s(e.loggingIn?"ç™»å½•ä¸­...":"ç™»å½•")+" ")])],1)],1)],1),e._m(1)])},i=[function(){var e=this,n=e._self._c;return n("div",{staticClass:"login-header"},[n("h1",{staticClass:"login-title"},[e._v("å­¦ç”Ÿä»»åŠ¡ç®¡ç†")]),n("p",{staticClass:"login-subtitle"},[e._v("è¯·ä½¿ç”¨é‚®ç®±éªŒè¯ç ç™»å½•")])])},function(){var e=this,n=e._self._c;return n("div",{staticClass:"login-tips"},[n("p",[e._v("ðŸ“§ é¦–æ¬¡ç™»å½•å°†è‡ªåŠ¨åˆ›å»ºè´¦å·")]),n("p",[e._v("ðŸ”’ éªŒè¯ç æœ‰æ•ˆæœŸä¸º5åˆ†é’Ÿ")]),n("p",[e._v("â° åŒä¸€é‚®ç®±1åˆ†é’Ÿå†…åªèƒ½å‘é€ä¸€æ¬¡éªŒè¯ç ")])])}],s=(t(8014),t(4202)),a=t(1406),l={name:"Login",data(){return{form:{email:"",code:""},sendingCode:!1,loggingIn:!1,countdown:0,countdownTimer:null,emailRules:[{required:!0,message:"è¯·è¾“å…¥é‚®ç®±åœ°å€"},{pattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"è¯·è¾“å…¥æ­£ç¡®çš„é‚®ç®±æ ¼å¼"}],codeRules:[{required:!0,message:"è¯·è¾“å…¥éªŒè¯ç "},{pattern:/^\d{6}$/,message:"éªŒè¯ç å¿…é¡»æ˜¯6ä½æ•°å­—"}]}},computed:{canSendCode(){return this.form.email&&/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(this.form.email)&&0===this.countdown},sendButtonText(){return this.sendingCode?"å‘é€ä¸­":this.countdown>0?`${this.countdown}såŽé‡è¯•`:"å‘é€éªŒè¯ç "}},beforeDestroy(){this.countdownTimer&&clearInterval(this.countdownTimer)},methods:{...(0,a.i0)(["sendVerifyCode","login"]),async handleSendCode(){if(this.canSendCode)try{this.sendingCode=!0,await this.sendVerifyCode(this.form.email),s.A.success("éªŒè¯ç å‘é€æˆåŠŸï¼Œè¯·æŸ¥æ”¶é‚®ä»¶"),this.startCountdown()}catch(e){console.error("å‘é€éªŒè¯ç å¤±è´¥:",e),s.A.fail(e.message||"å‘é€éªŒè¯ç å¤±è´¥")}finally{this.sendingCode=!1}},startCountdown(){this.countdown=60,this.countdownTimer=setInterval(()=>{this.countdown--,this.countdown<=0&&(clearInterval(this.countdownTimer),this.countdownTimer=null)},1e3)},async handleLogin(){if(this.form.email&&this.form.code)try{this.loggingIn=!0,await this.login({email:this.form.email,code:this.form.code}),s.A.success("ç™»å½•æˆåŠŸ");const e=this.$route.query.redirect||"/";this.$router.replace(e)}catch(e){console.error("ç™»å½•å¤±è´¥:",e),s.A.fail(e.message||"ç™»å½•å¤±è´¥")}finally{this.loggingIn=!1}}}},r=l,d=t(5229),c=(0,d.A)(r,o,i,!1,null,"4a222d5e",null),u=c.exports}}]);